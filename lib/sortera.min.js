// Licenced under MIT - sortera - Â©2016 Hexagon <github.com/hexagon>
(function(){"use strict";function b(a){throw new TypeError("sortera: "+a)}function c(a,d){d||(d=a,a=this[0]),d=d||{};var k,l,e=a.querySelector("thead"),f=e.querySelectorAll("thead td, th"),g=a.querySelector("tbody"),h=d.sortOrder||[],i=d.ignore||[],j=d.multi||!1,m=function(a,b){for(var c,d,g,m,n,o,p;p=e.querySelector(".s-arrow");)p.parentNode.removeChild(p);if(void 0!==a&&!~i.indexOf(a)){for(l=0;l<h.length;l++)if(h[l].col==a){c=l;break}void 0===c?(c=h.length,h.push({col:a,order:b||1})):b?h[c].order=b:1===h[c].order?h[c].order=-1:h.splice(c,1),!j&&h.length>1&&(h=[h[c]])}if(h.length>0){for(l=0;l<h.length;l++)n=h.length>1?"<sup>"+(l+1)+"</sup>":"",o=1==h[l].order?"&#9660":"&#9650;",f[h[l].col].innerHTML+='<b class="s-arrow"> '+o+n+"</b>";for(k.sort(function(a,b){for(l=0;l<h.length;){if(m=h[l],d=a.children[m.col],g=b.children[m.col],d.dataset.integer?(d=parseInt(d.dataset.integer),g=parseInt(g.dataset.integer)):d.dataset.float?(d=parseFloat(d.dataset.float),g=parseFloat(g.dataset.float)):d.dataset.value?(d=d.dataset.value,g=g.dataset.value):(d=d.textContent,g=g.textContent),d!==g)return m.order*(d<g?-1:1);l++}return 0}),l=0;l<k.length;l++)k[l].parentNode.appendChild(k[l].parentNode.removeChild(k[l]))}};if(!(this instanceof c))return new c(a,d);for(l=0;h[l];)~i.indexOf(h[l].col)&&b("Initially sorted by an ignored column"),~h[l].col||b("sortOrder contained invalid item"),h[l].order!==-1&&1!==h[l].order&&b("Invalid sort order: "+h[l].order),l++;g&&0!==g.length||(g=a),k=Array.prototype.slice.call(g.querySelectorAll("tr"),0);for(var n=0;n<f.length;n++)f[n].addEventListener("click",function(a){m(a.target.cellIndex)}),~i.indexOf(n)?f[n].className+=" s-not-sortable":f[n].className+=" s-sortable";try{m()}catch(a){console.error(a)}return{sort:m,clear:function(){h=[]},getOptions:function(){return d.sortOrder=h,d}}}var a=this;$&&$.fn&&($.fn.sortera=c),"function"==typeof define&&define.amd?define([],function(){return c}):"undefined"!=typeof module&&"object"==typeof module.exports?module.exports=c:a.sortera=c}).call(this);